<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WildLiveWatch ‚Äî Live Grid</title>

  <!-- Friendly jungle vibe -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#071a14;         /* deep jungle */
      --fg:#f1fff9;         /* minty text */
      --card:#0e2a21;       /* card background */
      --stroke:rgba(255,255,255,.12);
      --accent:#25a4ff;     /* sky */
      --accent2:#12d49e;    /* mint */
      --mango:#ffb901;      /* mango */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--fg); font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:
        radial-gradient(1200px 800px at 75% -10%, rgba(37,164,255,.22), transparent 60%),
        radial-gradient(900px 600px at 20% 110%, rgba(18,212,158,.18), transparent 60%),
        linear-gradient(180deg,#05140f,var(--bg));
    }

    /* Banner */
    .bannerWrap{padding:14px 14px 0}
    .banner{
      width:100%; height:auto; display:block; border-radius:18px;
      box-shadow:0 16px 40px rgba(0,0,0,.35); border:1px solid var(--stroke);
    }

    /* Header + Nav */
    header{
      position:sticky; top:0; z-index:10;
      display:grid; grid-template-columns:1fr auto; align-items:center; gap:12px;
      padding:12px 18px; background:rgba(7,26,20,.88); backdrop-filter:blur(6px);
      border-bottom:1px solid var(--stroke);
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px}
    .brandMark{
      width:36px; height:36px; border-radius:12px; display:grid; place-items:center;
      background:conic-gradient(from 120deg,var(--accent2),var(--accent),var(--mango));
      color:#052218; font-weight:900; box-shadow:0 6px 20px rgba(0,0,0,.35);
    }
    nav{display:flex; gap:10px; align-items:center}
    a.nav{
      text-decoration:none; color:var(--fg); font-weight:600; font-size:14px;
      padding:8px 12px; border-radius:999px; border:1px solid var(--stroke);
      background:rgba(255,255,255,.06);
    }
    a.nav:hover{background:rgba(255,255,255,.12)}

    .controls{margin-left:6px; display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    select,button,input[type="range"]{
      appearance:none; border:1px solid var(--stroke);
      background:#0c221b; color:var(--fg); border-radius:12px; padding:8px 10px; font:inherit;
    }

    /* Grid */
    .grid{padding:18px; display:grid; gap:14px; grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:920px){.grid{grid-template-columns:1fr}}

    .tile{
      position:relative; border-radius:18px; overflow:hidden; background:var(--card);
      border:1px solid var(--stroke); box-shadow:0 16px 40px rgba(0,0,0,.40);
      aspect-ratio:16/9; isolation:isolate;
    }
    .tile::before{
      content:""; position:absolute; inset:auto -20% -20% auto; width:55%; height:55%; transform:rotate(6deg);
      background:radial-gradient(closest-side, rgba(255,185,1,.14), transparent 70%); pointer-events:none; z-index:0;
    }
    .tile video{width:100%; height:100%; object-fit:cover; display:block; background:#000}

    .title{
      position:absolute; left:10px; top:10px; z-index:2; pointer-events:none; font-weight:700; font-size:14px;
      padding:6px 10px; border-radius:12px; color:#052218;
      background:linear-gradient(180deg,#2ef5c5,#1bdfab);
    }
    .overlay{position:absolute; inset:0; display:flex; align-items:flex-end; justify-content:space-between; padding:10px;
      pointer-events:none; z-index:2; background:linear-gradient(180deg, transparent 65%, rgba(0,0,0,.45))}
    .leftStack{display:flex; gap:8px; align-items:center; pointer-events:auto}
    .badge{font-size:12px; padding:5px 8px; border-radius:999px; background:rgba(0,0,0,.55); border:1px solid var(--stroke)}
    .controlsBar{display:flex; align-items:center; gap:8px; pointer-events:auto}
    .iconBtn{width:38px; height:38px; border-radius:12px; display:grid; place-items:center; cursor:pointer;
      background:rgba(0,0,0,.5); border:1px solid var(--stroke); color:var(--fg); transition:transform .08s, background .2s}
    .iconBtn:hover{transform:translateY(-1px); background:rgba(0,0,0,.6)}
    .range{width:130px; height:36px; display:inline-flex; align-items:center; padding:0 8px; gap:8px;
      border-radius:12px; background:rgba(0,0,0,.5); border:1px solid var(--stroke)}
    .range input{width:100%; background:transparent}

    .floatingHint{position:absolute; inset:0; display:grid; place-items:center; color:#e9fff7; pointer-events:none; z-index:1;
      opacity:0; transition:opacity .25s; text-shadow:0 2px 10px rgba(0,0,0,.6)}
    .tile.initial .floatingHint{opacity:1}

    footer{opacity:.8; padding: 0 18px 24px; text-align:center; font-size:12px}
  </style>
</head>
<body>
  <!-- Responsive banner -->
  <div class="bannerWrap">
    <picture>
      <source media="(max-width: 768px)" srcset="./mobile_banner.webp">
      <img class="banner" src="./desktop_banner.webp" alt="WildLiveWatch ‚Äî safari friends in a Madagascar sunset">
    </picture>
  </div>

  <header>
    <div class="brand">
      <div class="brandMark">üêæ</div>
      <div><span style="font-weight:700;">Wild</span>LiveWatch</div>
    </div>
    <div style="display:flex; align-items:center; gap:14px; flex-wrap:wrap; justify-self:end;">
      <nav>
        <a class="nav" href="/index.html">Home</a>
        <a class="nav" href="/gallery.html">Gallery</a>
        <a class="nav" href="/about.html">About</a>
        <a class="nav" href="/contact.html">Contact</a>
      </nav>
      <div class="controls">
        <label for="tileCount">Tiles:</label>
        <select id="tileCount">
          <option value="4">4</option>
          <option value="6" selected>6</option>
          <option value="8">8</option>
        </select>
        <button id="pauseAll">Pause all</button>
        <button id="playAll">Play all</button>
        <button id="muteAll">Mute all</button>
      </div>
    </div>
  </header>

  <main class="grid" id="grid"></main>

  <footer>
    Tip: Most browsers only allow <em>autoplay</em> when the video is <strong>muted</strong>. Click a tile to unmute it
    (only one tile has sound at a time).
  </footer>

  <template id="tileTpl">
    <article class="tile initial" data-id="">
      <div class="title"></div>
      <video playsinline muted autoplay loop preload="metadata" poster="" aria-label="Live camera feed"></video>
      <div class="floatingHint">Click to unmute üîä</div>
      <div class="overlay">
        <div class="leftStack">
          <span class="badge status">LIVE</span>
          <span class="badge latency" title="Mock latency">~2s</span>
        </div>
        <div class="controlsBar">
          <button class="iconBtn btnMute" title="Toggle mute">üîá</button>
          <div class="range" title="Volume">
            <span>üîä</span>
            <input class="vol" type="range" min="0" max="1" step="0.01" value="0.5" />
          </div>
          <button class="iconBtn btnPlay" title="Play / Pause">‚èØ</button>
          <button class="iconBtn btnFs" title="Fullscreen">‚õ∂</button>
        </div>
      </div>
    </article>
  </template>

  <!-- HLS support -->
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script>
    // Swap in your real feeds (m3u8 auto-uses Hls; MP4 plays natively)
    const STREAMS = [
      { title: "Savannah Cam",     src: "https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8", poster: "" },
      { title: "Forest Waterhole", src: "https://test-streams.mux.dev/test_001/stream.m3u8", poster: "" },
      { title: "Cliff Rookery",    src: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4", poster: "" },
      { title: "River Bend",       src: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4", poster: "" },
      { title: "Desert Den",       src: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4", poster: "" },
      { title: "Rainforest Canopy",src: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4", poster: "" },
      { title: "Mountain Pass",    src: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4", poster: "" },
      { title: "Delta Marsh",      src: "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4", poster: "" },
    ];

    const DEFAULT_TILES = 6;

    const grid = document.getElementById('grid');
    const tileCountSel = document.getElementById('tileCount');
    const btnPauseAll = document.getElementById('pauseAll');
    const btnPlayAll  = document.getElementById('playAll');
    const btnMuteAll  = document.getElementById('muteAll');
    let tiles = [];

    const isHls = url => /\.m3u8($|\?)/i.test(url);
    function attachSource(video, url){
      if (isHls(url)) {
        if (window.Hls && Hls.isSupported()){
          const hls = new Hls({lowLatencyMode:true});
          hls.loadSource(url); hls.attachMedia(video);
          return hls;
        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
          video.src = url;
        }
      } else { video.src = url; }
      return null;
    }

    function renderTiles(n){
      grid.innerHTML=''; tiles=[];
      const tpl = document.getElementById('tileTpl');
      for (let i=0;i<n;i++){
        const data = STREAMS[i % STREAMS.length];
        const node = tpl.content.firstElementChild.cloneNode(true);
        const v = node.querySelector('video');
        node.querySelector('.title').textContent = data.title;
        v.poster = data.poster || '';
        v.muted = true; v.volume=.5; v.autoplay=true; v.loop=true; v.playsInline=true;
        attachSource(v, data.src);

        // Interactions
        node.addEventListener('click', e => {
          if (e.target.closest('.controlsBar')) return;
          toggleMute(node, false);
        });
        node.querySelector('.btnMute').addEventListener('click', e => { e.stopPropagation(); toggleMute(node, !v.muted); });
        node.querySelector('.btnPlay').addEventListener('click', e => { e.stopPropagation(); if (v.paused) v.play(); else v.pause(); updateBtns(node,v); });
        node.querySelector('.btnFs').addEventListener('click', e => { e.stopPropagation(); if (document.fullscreenElement) document.exitFullscreen(); else node.requestFullscreen().catch(()=>{}); });
        node.querySelector('.vol').addEventListener('input', e => { v.volume = parseFloat(e.target.value); if (v.muted && v.volume>0) toggleMute(node,false); });
        v.addEventListener('play', () => node.classList.remove('initial'));
        node.addEventListener('pointerdown', () => { if (v.paused) v.play().catch(()=>{}); });

        grid.appendChild(node);
        tiles.push({el:node, video:v});
        updateBtns(node,v);
      }
    }

    function toggleMute(target, keepMuted){
      tiles.forEach(({el,video})=>{
        if (el===target){
          video.muted = keepMuted;
          if (!keepMuted){ video.muted=false; video.play().catch(()=>{}); }
        } else { video.muted = true; }
        updateBtns(el,video);
      });
    }
    function updateBtns(el,v){
      el.querySelector('.btnMute').textContent = v.muted ? 'üîá' : 'üîä';
      el.querySelector('.btnPlay').textContent = v.paused ? '‚ñ∂' : '‚è∏';
    }

    tileCountSel.addEventListener('change', ()=> renderTiles(parseInt(tileCountSel.value,10)));
    btnPauseAll.addEventListener('click', ()=> tiles.forEach(t=>{ t.video.pause(); updateBtns(t.el,t.video); }));
    btnPlayAll .addEventListener('click', ()=> tiles.forEach(t=>{ t.video.play().catch(()=>{}); updateBtns(t.el,t.video); }));
    btnMuteAll .addEventListener('click', ()=> tiles.forEach(t=>{ t.video.muted=true; updateBtns(t.el,t.video); }));

    renderTiles(DEFAULT_TILES);
    tileCountSel.value = String(DEFAULT_TILES);
  </script>
</body>
</html>
